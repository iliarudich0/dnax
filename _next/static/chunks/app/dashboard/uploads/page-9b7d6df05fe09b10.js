(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[250],{580:function(e,t,r){Promise.resolve().then(r.bind(r,8965))},8965:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return y}});var n=r(7437),i=r(2265),a=r(3987);let s=(0,r(6497).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);var l=r(495),o=r(6013),d=r(3102),u=r(7412),c=r(4693),f=r(9406);let p=[".txt",".csv"];var m=r(8964),x=r(637),h=r(8428),g=r(1839);function y(){let{user:e}=(0,f.a)(),[t,r]=(0,i.useState)([]),[y,v]=(0,i.useState)(null),[b,w]=(0,i.useState)(!1),[j,N]=(0,i.useState)(7),[k,S]=(0,i.useState)(!1),E=(0,i.useMemo)(()=>p.join(", "),[]);(0,i.useEffect)(()=>{e&&(async()=>{let[t,n]=await Promise.all([(0,h.nK)(e.id),(0,h.Gw)(e.id)]);r(t),(null==n?void 0:n.retentionDays)&&N(n.retentionDays),(null==n?void 0:n.encryptionEnabled)!==void 0&&S(n.encryptionEnabled)})()},[e]);let _=async t=>{if(!e)return;v(null);let n=t.name.slice(t.name.lastIndexOf(".")).toLowerCase();if(!p.includes(n)){v("Unsupported file type. Allowed: ".concat(E));return}if(t.size>26214400){v("File too large. Please upload a file under 25MB.");return}w(!0);try{let n=await t.arrayBuffer(),i=new TextDecoder().decode(n),a=(0,m.hI)(i),s=new Date,l=new Date(s.getTime()+864e5*j).toISOString(),o=await (0,h.iP)(e.id,{fileName:t.name,provider:a.provider,size:t.size,createdAt:s.toISOString(),status:"processing",summary:{totalSnps:a.summary.totalLines,parsedSnps:a.summary.parsedSnps,chromosomes:a.summary.chromosomes},rawExpiresAt:l}),d=(0,m.NM)(o.id,a),u=d.snps.filter(e=>x.bu.includes(e.rsid)),c={};x.bu.forEach(e=>{var t;c[e]=null!==(t=d.genotypeMap[e])&&void 0!==t?t:"--"});let f=(0,x.fh)(d.genotypeMap),p=k?await (0,g.k)():void 0;await Promise.all([(0,h.g7)(e.id,o.id,n,k,null!=p?p:void 0,l),(0,h.KK)(e.id,o.id,{...d,snps:u,genotypeMap:c}),(0,h.kz)(e.id,o.id,f)]),await (0,h.gI)(e.id,o.id,{status:"ready",processedAt:new Date().toISOString()});let y=await (0,h.nK)(e.id);r(y)}catch(e){v(e instanceof Error?e.message:"Upload failed")}finally{w(!1)}},A=async t=>{e&&(await (0,h.HZ)(e.id,t),await (0,h.H6)(e.id,t),r(await (0,h.nK)(e.id)))};return(0,n.jsxs)("div",{className:"grid gap-6",children:[(0,n.jsxs)(o.Zb,{className:"border-border/70 bg-white/90",children:[(0,n.jsxs)(o.Ol,{children:[(0,n.jsx)(o.ll,{children:"Upload raw DNA"}),(0,n.jsxs)(o.SZ,{children:["Supported formats: 23andMe, AncestryDNA, MyHeritage (",E,")."]})]}),(0,n.jsxs)(o.aY,{className:"space-y-4",children:[y&&(0,n.jsx)(u.b,{variant:"destructive",children:(0,n.jsx)(u.X,{children:y})}),(0,n.jsx)(d.I,{type:"file",accept:p.join(","),onChange:e=>{var t;let r=null===(t=e.target.files)||void 0===t?void 0:t[0];r&&_(r)},disabled:b}),(0,n.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[(0,n.jsx)(a.Z,{className:"h-4 w-4"})," Files are private and auto-deleted after ",j," days."]})]})]}),(0,n.jsxs)("div",{className:"grid gap-4",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("h2",{className:"text-lg font-semibold",children:"Uploads"}),(0,n.jsx)(c.C,{variant:"secondary",children:t.length})]}),0===t.length?(0,n.jsx)(o.Zb,{className:"border-border/70 bg-white/90",children:(0,n.jsx)(o.aY,{className:"py-10 text-center text-sm text-muted-foreground",children:"No uploads yet. Upload a raw DNA file to generate traits."})}):(0,n.jsx)("div",{className:"grid gap-3",children:t.map(e=>(0,n.jsx)(o.Zb,{className:"border-border/70 bg-white/90",children:(0,n.jsxs)(o.aY,{className:"flex flex-wrap items-center justify-between gap-4 py-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"font-semibold",children:e.fileName}),(0,n.jsx)("p",{className:"text-xs text-muted-foreground",children:e.provider}),(0,n.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Parsed ",e.summary.parsedSnps," SNPs ? Status ",e.status]})]}),(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)(c.C,{variant:"outline",children:e.rawExpiresAt?"Raw expires ".concat(new Date(e.rawExpiresAt).toLocaleDateString()):"Retention not set"}),(0,n.jsx)(l.z,{variant:"ghost",size:"icon",onClick:()=>A(e.id),children:(0,n.jsx)(s,{className:"h-4 w-4"})})]})]})},e.id))})]})]})}},7412:function(e,t,r){"use strict";r.d(t,{X:function(){return l},b:function(){return s}});var n=r(7437),i=r(2265),a=r(7440);let s=i.forwardRef((e,t)=>{let{className:r,variant:i="default",...s}=e;return(0,n.jsx)("div",{ref:t,role:"alert",className:(0,a.cn)("relative w-full rounded-lg border px-4 py-3 text-sm","destructive"===i?"border-destructive/40 bg-destructive/5 text-destructive":"border-border bg-white/90 text-foreground",r),...s})});s.displayName="Alert";let l=i.forwardRef((e,t)=>{let{className:r,...i}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("text-sm text-muted-foreground",r),...i})});l.displayName="AlertDescription"},495:function(e,t,r){"use strict";r.d(t,{z:function(){return d}});var n=r(7437),i=r(2265),a=r(1538),s=r(3027),l=r(7440);let o=(0,s.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-2xl text-sm font-semibold transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-60 ring-offset-background shadow-[0_10px_40px_-28px_rgba(16,185,129,0.8)]",{variants:{variant:{default:"bg-gradient-to-r from-emerald-500 to-cyan-500 text-white hover:brightness-110",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",secondary:"border border-border bg-white/70 text-foreground hover:border-foreground/60 hover:bg-white/80",ghost:"hover:bg-muted/80 text-foreground",outline:"border border-emerald-200 text-foreground hover:border-emerald-400 hover:bg-emerald-50",link:"text-emerald-600 underline-offset-4 hover:underline"},size:{default:"h-11 px-5",sm:"h-9 rounded-xl px-4 text-xs",lg:"h-12 rounded-3xl px-6 text-base",icon:"h-11 w-11 rounded-2xl"}},defaultVariants:{variant:"default",size:"default"}}),d=i.forwardRef((e,t)=>{let{className:r,variant:i,size:s,asChild:d=!1,...u}=e,c=d?a.g7:"button";return(0,n.jsx)(c,{className:(0,l.cn)(o({variant:i,size:s,className:r})),ref:t,...u})});d.displayName="Button"},3102:function(e,t,r){"use strict";r.d(t,{I:function(){return s}});var n=r(7437),i=r(2265),a=r(7440);let s=i.forwardRef((e,t)=>{let{className:r,type:i,...s}=e;return(0,n.jsx)("input",{type:i,className:(0,a.cn)("flex h-11 w-full rounded-2xl border border-input bg-white/60 px-4 text-sm shadow-sm transition focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-60 dark:bg-white/10",r),ref:t,...s})});s.displayName="Input"},1839:function(e,t,r){"use strict";r.d(t,{L:function(){return s},k:function(){return a}});var n=r(1860);let i="genomelink_encryption_key";async function a(){let e=window.localStorage.getItem(i);if(e)return e;let t=await (0,n.cU)();return window.localStorage.setItem(i,t),t}function s(){window.localStorage.removeItem(i)}},1584:function(e,t,r){"use strict";r.d(t,{F:function(){return a},e:function(){return s}});var n=r(2265);function i(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function a(...e){return t=>{let r=!1,n=e.map(e=>{let n=i(e,t);return r||"function"!=typeof n||(r=!0),n});if(r)return()=>{for(let t=0;t<n.length;t++){let r=n[t];"function"==typeof r?r():i(e[t],null)}}}}function s(...e){return n.useCallback(a(...e),e)}},1538:function(e,t,r){"use strict";r.d(t,{Z8:function(){return u},g7:function(){return c}});var n,i=r(2265),a=r(1584),s=r(7437),l=Symbol.for("react.lazy"),o=(n||(n=r.t(i,2)))[" use ".trim().toString()];function d(e){var t;return null!=e&&"object"==typeof e&&"$$typeof"in e&&e.$$typeof===l&&"_payload"in e&&"object"==typeof(t=e._payload)&&null!==t&&"then"in t}function u(e){let t=function(e){let t=i.forwardRef((e,t)=>{let{children:r,...n}=e;if(d(r)&&"function"==typeof o&&(r=o(r._payload)),i.isValidElement(r)){var s;let e,l;let o=(s=r,(e=Object.getOwnPropertyDescriptor(s.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning?s.ref:(e=Object.getOwnPropertyDescriptor(s,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning?s.props.ref:s.props.ref||s.ref),d=function(e,t){let r={...t};for(let n in t){let i=e[n],a=t[n];/^on[A-Z]/.test(n)?i&&a?r[n]=(...e)=>{let t=a(...e);return i(...e),t}:i&&(r[n]=i):"style"===n?r[n]={...i,...a}:"className"===n&&(r[n]=[i,a].filter(Boolean).join(" "))}return{...e,...r}}(n,r.props);return r.type!==i.Fragment&&(d.ref=t?(0,a.F)(t,o):o),i.cloneElement(r,d)}return i.Children.count(r)>1?i.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}(e),r=i.forwardRef((e,r)=>{let{children:n,...a}=e;d(n)&&"function"==typeof o&&(n=o(n._payload));let l=i.Children.toArray(n),u=l.find(p);if(u){let e=u.props.children,n=l.map(t=>t!==u?t:i.Children.count(e)>1?i.Children.only(null):i.isValidElement(e)?e.props.children:null);return(0,s.jsx)(t,{...a,ref:r,children:i.isValidElement(e)?i.cloneElement(e,void 0,n):null})}return(0,s.jsx)(t,{...a,ref:r,children:n})});return r.displayName=`${e}.Slot`,r}var c=u("Slot"),f=Symbol("radix.slottable");function p(e){return i.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===f}},6497:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});var n=r(2265);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let i=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),a=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var s={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,n.forwardRef)((e,t)=>{let{color:r="currentColor",size:i=24,strokeWidth:l=2,absoluteStrokeWidth:o,className:d="",children:u,iconNode:c,...f}=e;return(0,n.createElement)("svg",{ref:t,...s,width:i,height:i,stroke:r,strokeWidth:o?24*Number(l)/Number(i):l,className:a("lucide",d),...f},[...c.map(e=>{let[t,r]=e;return(0,n.createElement)(t,r)}),...Array.isArray(u)?u:[u]])}),o=(e,t)=>{let r=(0,n.forwardRef)((r,s)=>{let{className:o,...d}=r;return(0,n.createElement)(l,{ref:s,iconNode:t,className:a("lucide-".concat(i(e)),o),...d})});return r.displayName="".concat(e),r}},3987:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(6497).Z)("CloudUpload",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]])}},function(e){e.O(0,[358,637,717,934,406,954,971,23,744],function(){return e(e.s=580)}),_N_E=e.O()}]);